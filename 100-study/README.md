# Shell编程知识点


Table of Contents
=================

   * [Shell编程知识点](#shell编程知识点)
      * [运行](#运行)
      * [变量](#变量)
         * [设置环境变量](#设置环境变量)
         * [位置参数变量](#位置参数变量)
         * [预定义变量](#预定义变量)
      * [运算符](#运算符)
      * [判断语句](#判断语句)
         * [条件判断](#条件判断)
         * [判断符号](#判断符号)
      * [流程控制](#流程控制)
         * [分支](#分支)
            * [if](#if)
            * [case](#case)
         * [循环](#循环)
            * [for](#for)
            * [while](#while)
      * [read读取控制台输入](#read读取控制台输入)
      * [函数](#函数)
         * [库函数](#库函数)
         * [用户自定义函数](#用户自定义函数)
	 
	 
## 运行

- 告诉解释器是以/bash/shell这个解释器来解析shell脚本

  ```shell
  #!/bin/bash
  ```

- **运行:**

  1. 先赋予可执行权限
     - 可使用相对路径执行`./study.sh`
     - 也可使用绝对路径执行`/root/文档/Shell/study/study.sh `
  2. `sh study.sh`: 不用给可执行权限(不推荐)

- 注释

  - 单行注释: `# 这里是注释的内容`

  - 多行注释

    ```shell
    :<<!
    这里是
    注释
    的内容
    !
    ```

------

## 变量

- 变量类型:
  - 系统变量
  - 用户自定义变量
- 查看所有变量: `set`
- **定义变量:**
  - 等号两侧不能有空格
  - 一般使用大写
  - **将命令的返回值赋给变量:** \`ls -l\`  <=>  $(ls -l)

### 设置环境变量

可以理解为超全局的变量

例. 在`/etc/profile`中定义一个变量`TOMCAY_HOME`, 在其他shell脚本中可以使用

1. 编辑该文件

   ```shell
   TOMCAT_HOME=/etc/profile
   export TOMCAT_HOME
   ```

2. 刷新文件

   ```shell
   source /etc/profile
   ```

3. 可以直接在终端中`echo $TOMCAT_HOME`

4. 也可以在自己写的shell脚本中使用

### 位置参数变量

获取在命令行的参数信息

- `$数字`: 第几个参数的值, 10以上要用`${10}`
- `$*`: 全部的参数, 当成整体
- `$@`": 全部参数, 区分对待
- `$#`: 参数个数

### 预定义变量

- `$$`: 当前进程的PID
- `$!`: 后台运行的最后一个进程的PID
- `$?`: 最后一次执行的命令状态 (0 -> 上一个命令正确执行; 非0 -> 不正确)

------

## 运算符

- `$[表达式]`
- `$((表达式))`
- `expr 表达式`
  - 这里的表达式运算符前后要后空格: 例`expr 2 + 3`
  - 乘法: `\*`
  - 尽量分步写

------

## 判断语句

### 条件判断

`[ condition ]`: 两端有空格

### 判断符号

- 两个整数的比较
  - `=`: 字符串比较
  - `-lt`: 小于
  - `-le`: 小于等于
  - `-eq`: 等于
  - `-gt`: 大于
  - `-ge`: 大于等于
  - `-ne`: 不等于
- 文件权限
  - `-r`: 有读的权限
  - `-w`: 写
  - `-x`: 执行
- 文件类型
  - `-f`: 文件存在并且是一个常规文件
  - `-e`: 文件存在
  - `-d`: 文件存在并是一个目录

------

## 流程控制

### 分支

#### if

```shell
if [ 条件判断式 ]
then
	...
elif [ 条件判断式 ]
then
	...
else
	...
fi
```

#### case

```shell
case $变量名 in
    "值1")
    ...程序1
    ;;
    "值2")
    ...程序2
    ;;
    *)
    ..没有匹配的默认程序
    ;;
easc
```

### 循环

#### for

```shell
# 遍历后面的值(把后面的值一次次的给变量)    
# 不是说当变量在那些值中的时候遍历
for 变量 in 值1 值2 值3
do
	程序...
done
```

```shell
for((初始值;循环控制条件;变量变化))
do
	程序...
done
```

#### while

```shell
while [ 条件判断式 ]
do
	程序...
done
```

------

## read读取控制台输入

- `read 选项 参数`
  - `-p`: 指定读取时的提示信息(给用户的提示信息)
  - `-t`: 读取时的等待时间, 如果在指定时间没有输入, 就不等待了
  - 参数: 指定读取值时的变量名

------

## 函数

### 库函数

- `basename`: 获取文件名
  - `basename 路径名 后缀名`: 删掉所有的前缀包括最后一个 / , 然后将字符串显示出来
  - 后缀名如果被指定了, 则最终获取的文件名中也会把后缀名去掉
- `dirname`: 返回路径
  - `dirname 文件绝对路径`: 去除文件名, 返回剩下的路径(目录部分)

### 用户自定义函数

```shell
# 函数的()中不需要写形参
function 函数名(){
	...
}

# 调用
函数名 $实参1 $实参2
```

------

